<!DOCTYPE html>
<html>
  <head>
    <title>Airtable Record Count</title>
  </head>
  <body>
    <h2>Total Records in Airtable</h2>
    <p id="result"></p>
    <h1 id="count">Loading...</h1>

    <script>
      const BASE_ID = "appDe178p7M9yfTub";
      const TABLE_NAME = "Executives";
      const TOKEN =
        "pat3Bzs2EBZD2Gxjl.2c0bd7cabdaa9c67ac330f9894f8f873d9952d62820e1064ad99ab46bed3f742";

      let totalCount = 0;
      let offset = "";

      function getRecords() {
        let url = "https://api.airtable.com/v0/" + BASE_ID + "/" + TABLE_NAME;

        if (offset !== "") {
          url = url + "?offset=" + offset;
        }

        fetch(url, {
          headers: {
            Authorization: "Bearer " + TOKEN,
          },
        })
          .then(function (response) {
            return response.json();
          })
          .then(function (data) {
            // document.getElementById("result").innerHTML = data + data.records;
            // console.log(data);
            // console.log(data.records);
            totalCount = totalCount + data.records.length;
            // console.log(data.offset);

            if (data.offset) {
              offset = data.offset;
              // document.getElementById("result").innerHTML = data + data.records;
              getRecords();
            } else {
              document.getElementById("count").innerHTML = totalCount;
            }
          })
          .catch(function (error) {
            console.log("Error:", error);
          });
      }

      getRecords();
    </script>
  </body>
</html>
